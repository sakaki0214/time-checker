<!DOCTYPE html>
<html lang="ja">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta charset="utf-8">
<title>TIME CHECKER</title>
<meta name="keywords" content="">
<meta name="description" content="">
<meta property="og:title" content="">
<meta property="og:type" content="website">
<meta property="og:description" content="">
<meta property="og:url" content="http://">
<meta property="og:site_name" content="">
<meta property="og:image" content="http://">
<meta property="fb:app_id" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<link href="https://fonts.googleapis.com/css?family=Poiret+One" rel="stylesheet" type="text/css">
<style>
.project-list:after {
  content:"";
  display: table;
  clear:both;
}
.project-list li {
  float:left;
  width: 200px;
  margin:0 10px 10px 0;
  padding:10px;
  border: 1px solid #ccc;
}
.project-list span {
  display: block;
}
.project-list a {
  display: inline-block;
  padding:0 5px 0 0;
}
.project-name {

}
.project-time {

}
</style>
</head>
<body>
<header>
  <h1 class="site-heading">TIME CHECKER</h1>
</header>

<form>
<ul class="btn-set">
  <li class="btn-add"><input type="text" name="" placeholder="PROJECT NAME" class="tx-project"><input type="submit" valur="ADD" class="btn-submit"></li>
  <li class="btn-all-reset"><a href="#">RESET ALL TIME</a></li>
  <li class="btn-all-delete"><a href="#">DELETE ALL PROJECT</a></li>
</ul>
</form>

<ul class="project-list">
</ul>


<!-- <ul class="project-list">
  <li class="item" id="sw1">
    <span class="project-name">あ1</span><span class="project-time">00:00:00</span>
    <a href="#" class="btn-start">START</a>
    <a href="#" class="btn-stop">STOP</a>
    <a href="#" class="btn-delete">DELETE</a>
  </li>
  <li class="item" id="sw2">
    <span class="project-name">あ2</span><span class="project-time">00:00:00</span><a href="#" class="btn-start">START</a><a href="#" class="btn-stop">STOP</a><a href="#" class="btn-delete">DELETE</a>
  </li>
  <li class="item" id="sw3">
    <span class="project-name">あ3</span><span class="project-time">00:00:00</span><a href="#" class="btn-start">START</a><a href="#" class="btn-stop">STOP</a><a href="#" class="btn-delete">DELETE</a>
  </li>
  <li class="item" id="sw4">
    <span class="project-name">あ4</span><span class="project-time">00:00:00</span><a href="#" class="btn-start">START</a><a href="#" class="btn-stop">STOP</a><a href="#" class="btn-delete">DELETE</a>
  </li>
</ul> -->

<footer>
  <p class="cr"><small>&copy; think-L</small></p>
</footer>

<script src="http://code.jquery.com/jquery-2.1.4.js"></script>
<script>
$(function(){
  'use strict';

  var $list = $('.project-list');
  var $input = $('.btn-add .tx-project');
  var $projectName = $('.btn-add .tx-project');

  var $this = $(this);

  //ページを読み込んだ時にフォーカスが入力フォームにあたるように
  $(window).on('load', function(){
    $projectName.focus();
  });

  //プロジェクトを追加する関数
  function addProject(text) {

    //project itemを作成
    var $li = $('<li class="item">');
    var $text = $('<span class="project-name">').text(text);
    var $text2 = $('<span class="project-time">').text('00:00:00');
    var $btnStart = $('<a href="#" class="btn-start">').text('START');
    var $btnStop = $('<a href="#" class="btn-stop">').text('STOP');
    var $btnDelete = $('<a href="#" class="btn-delete">').text('DELETE');
    $li.append($text).append($text2).append($btnStart).append($btnStop).append($btnDelete);

    //ulに追加
    $list.append($li);

    $list.find('li').each(function(i){
      $(this).attr('id', 'sw' + (i+1));
    });
  }

  //フォームを送信した時の処理
  $('form').on('submit', function(event){
    event.preventDefault();

    //テキストボックスに入っている文字列を取得
    var text = $input.val();

    //todoを追加
    addProject(text);

    $input.val('');
    $projectName.focus();
  });
  //

  //クラス作成＆コンストラクタ
  var WorkTimer = function(_itemId){
    var self = this;

    this.ulParent = '.project-list';
    this.continerSelecter = '#'+_itemId;
    this.startBtnSelecter = '.btn-start';
    this.stopBtnSelecter = '.btn-stop';
    this.resetBtnSelecter = '.btn-reset';
    this.timerTextSelecter = '.project-time';
    this.intervalId = null;

    //クリックイベント登録
    $(this.ulParent+'>'+this.continerSelecter+'>'+this.startBtnSelecter).click(function(e){
      e.preventDefault();
      self.start();
    });
    $(this.continerSelecter+'>'+this.stopBtnSelecter).click(function(e){
      e.preventDefault();
      self.stop();
    });

    // $(this.continerSelecter+'>'+this.resetBtnSelecter).click(function(e){
    //   e.preventDefault();
    //   self.reset();
    // });
  };

  //各function
  WorkTimer.prototype.start = function(){
    this.run();
  };
  WorkTimer.prototype.stop = function(){
    if(this.intervalId !== null){
        clearInterval(this.intervalId);
        this.intervalId = null; // add
    }
  };
  // WorkTimer.prototype.reset = function(){
  //   this.stop();
  //   $(this.continerSelecter+'>'+this.timerTextSelecter).text('00:00:00');
  // };

  WorkTimer.prototype.run = function(){
    var self = this;
    var passedTime = 0; //add
    if (this.intervalId != null) {
      return;
    }
    this.intervalId = setInterval(function(){

        //動くコード
        // var passedTime = $(self.continerSelecter+'>'+self.timerTextSelecter).text();
        // $(self.continerSelecter+'>'+self.timerTextSelecter).text(parseInt(passedTime,10)+1);

        //調整中
        var passedTime = $(self.continerSelecter+'>'+self.timerTextSelecter).text();
        console.log(passedTime);
        passedTime = parseInt(passedTime,10)+1;
        var seconds = parseInt(passedTime % 60,10);
        var minutes = Math.floor(passedTime / 60) % 60;
        var hours = Math.floor(passedTime / 3600);

        console.log(hours + ':' + minutes + ':' + seconds);

        $(self.continerSelecter+'>'+self.timerTextSelecter).text(parseInt(seconds,10));


    }, 1000);


  };

  // main処理
    $('form').on('submit', function(){
      main();
    });

    var liCount = 0;
    function main(){
      liCount++;
      var sw = 'sw' + liCount;
      var sw = new WorkTimer(sw);
    }

  //各DELETEボタンを押した時の処理
  $('.project-list').on('click', '.btn-delete',  function(){
    $(this).parent('li').hide();
    return false;
  });



});
</script>
</body>
</html>
